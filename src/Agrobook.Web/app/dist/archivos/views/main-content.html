<div ng-controller="mainContentController as vm">
    <md-button class="md-fab md-fab-top-right"
               ng-click="vm.toggleSideNav()"
               ng-hide="vm.isSideNavOpen() || !vm.puedeCambiarProductores"
               aria-label="Seleccionar productor">
        <md-tooltip md-direction="left">Seleccionar otro productor</md-tooltip>
        <ng-md-icon icon="people"></ng-md-icon>
    </md-button>

    <div layout-gt-xs="row" layout="column">

        <div flex-gt-sm="50" flex>
            <div layout-padding flex-xs="70">
                <md-autocomplete md-search-text="vm.searchText"
                                 md-items="item in vm.productores | filter: vm.searchText"
                                 md-item-text="item.id"
                                 md-min-length="100"
                                 placeholder="Buscar">
                    <md-not-found>
                        Ninguno coincide con "{{vm.searchText}}".
                    </md-not-found>
                </md-autocomplete>
            </div>
            <md-content layout="column" style="overflow-y:scroll;height:calc(100vh - 135px);">
                <md-list flex>
                    <!--class="md-dense"-->
                    <md-list-item class="md-3-line"
                                  ng-click="vm.seleccionarArchivo(archivo)"
                                  ng-repeat="archivo in vm.archivosFiltrados | filter:vm.searchText"
                                  title="{{archivo.nombre}}">
                        <img ng-if="vm.archivosQueryService.esFoto(archivo.extension)"
                             ng-src="./archivos/query/file-icon/{{vm.idProductor}}/{{archivo.nombre}}/{{archivo.extension}}"
                             class="md-avatar"
                             alt="pic" />
                        <md-icon ng-if="!vm.archivosQueryService.esFoto(archivo.extension)"
                                 md-svg-icon="{{vm.archivosQueryService.resolverIcono(archivo.extension)}}"></md-icon>
                        <div class="md-list-item-text" layout="column">
                            <p md-truncate
                               style="color: black;font-weight:100"
                               ng-class="{'archivo-seleccionado': vm.archivoSeleccionado === archivo}">
                                {{archivo.nombre}}
                            </p>
                            <h4 style="color:#7a7a7a;">{{archivo.fecha}}</h4>
                            <p>{{archivo.desc}}</p>
                        </div>
                        <md-button class="md-secondary md-icon-button"
                                   style="color: rgb(76, 175, 80);"
                                   aria-label="download"
                                   ng-click="vm.download(archivo)">
                            <ng-md-icon icon="file_download"></ng-md-icon>
                        </md-button>
                    </md-list-item>
                </md-list>
            </md-content>
        </div>

        <!--<md-divider></md-divider>-->

        <div flex-gt-xs="50" hide-xs flex>
            <md-content class="md-padding" layout="column">

                <div class="archivo-seleccione-por-favor" ng-hide="vm.archivoSeleccionado">
                    <p><ng-md-icon icon="remove_red_eye"></ng-md-icon></p>
                    <h3>Seleccione un archivo para ver más</h3>
                </div>
                
                <div class="archivo-seleccionado-preview">
                    <md-card md-theme="{{vm.obtenerTemaDePreview()}}"
                             ng-show="vm.archivoSeleccionado">
                        <md-card-header>
                            <md-card-avatar>
                                <md-icon style="background-color: rgba(0,0,0,0)"
                                         md-svg-icon="{{vm.archivosQueryService.resolverIcono(vm.archivoSeleccionado.extension)}}"></md-icon>
                            </md-card-avatar>
                            <md-card-header-text>
                                <span class="md-title">Archivo</span>
                                <span class="md-subhead">{{vm.archivoSeleccionado.extension}}</span>
                            </md-card-header-text>
                        </md-card-header>
                        <img ng-if="vm.archivosQueryService.esFoto(vm.archivoSeleccionado.extension)"
                             ng-src="./archivos/query/file-icon/{{vm.idProductor}}/{{vm.archivoSeleccionado.nombre}}/{{vm.archivoSeleccionado.extension}}" class="md-card-image" alt="Foto Preview">
                        <md-card-title>
                            <md-card-title-text>
                                <span class="md-headline">{{vm.archivoSeleccionado.nombre}}</span>
                                <span class="md-subhead">{{vm.archivoSeleccionado.fecha}}</span>
                            </md-card-title-text>
                        </md-card-title>
                        <md-card-actions layout="row" layout-align="start center">
                            <md-button ng-click="vm.download(vm.archivoSeleccionado)"
                                       class="md-primary md-raised">
                                <ng-md-icon icon="file_download"></ng-md-icon>&nbsp;Descargar&nbsp;
                            </md-button>
                            <!--<md-button>Action 2</md-button>-->
                        </md-card-actions>
                        <md-card-content>
                            <p>{{vm.archivoSeleccionado.desc}}</p>
                        </md-card-content>
                    </md-card>
                </div>


            </md-content>
        </div>

    </div>

    <div flex></div>
</div>